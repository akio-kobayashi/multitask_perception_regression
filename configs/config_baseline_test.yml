# Config for running the baseline single-task AttentionHubertCornModel
# This config should be used with the original hubert_train.py and run_one_speaker_out.sh
# The train/valid paths will be overwritten by the run script.
train_path: "path/to/train.csv"
valid_path: "path/to/valid.csv"
output_csv: "predictions_baseline.csv"

batch_size: 32
process:
  num_workers: 4

trainer:
  max_epochs: 50
  gradient_clip_val: 1.0

# Select the specific, original model class
model:
  class_name: 'AttentionHubertCornModel'
  hubert_dim: 768
  embed_dim: 256
  num_classes: 9
  n_heads: 4
  dropout_rate: 0.3

# Use the hyperparameters that were believed to be correct for this model
optimizer:
  type: AdamW
  lr: 1e-4
  betas: [0.9, 0.999]
  weight_decay: 1e-6

scheduler:
  mode: "min"
  factor: 0.99
  patience: 5
  verbose: true

# Checkpoint based on validation accuracy, as in the original solver
checkpoint:
  dirpath: "checkpoints_baseline"
  filename: "{epoch}-{val_acc:.3f}"
  monitor: "val_acc"
  mode: "max"
  save_top_k: 1

logger:
  save_dir: "logs"
  name: "baseline_test"
  version: 0
