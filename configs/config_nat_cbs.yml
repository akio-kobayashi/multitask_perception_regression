# Train naturalness and cbs
train_path: "path/to/train.csv"
valid_path: "path/to/valid.csv"
output_csv: "predictions.csv"

batch_size: 32
process: {num_workers: 0}
trainer: {max_epochs: 50}

model:
  backbone:
    type: 'attention'
    params:
      embed_dim: 256
      n_heads: 4
      dropout_rate: 0.3
  tasks:
    naturalness:
      loss: coral
      loss_weight: 1.0
      params:
        num_classes: 9
    cbs:
      loss: bce
      loss_weight: 0.5
      params:
        num_labels: 4

optimizer:
  type: AdamW
  lr: 0.001
  betas: [0.9, 0.999]
  weight_decay: 0.0001

scheduler:
  mode: "max"
  factor: 0.5
  patience: 3
  verbose: true

checkpoint:
  dirpath: "checkpoints/nat_cbs"
  filename: "{epoch}-{val_acc_naturalness:.3f}"
  monitor: "val_acc_naturalness" # Monitor primary task
  mode: "max"
  save_top_k: 1

logger:
  save_dir: "logs"
  name: "nat_cbs"
  version: 0
